# Noesis API - Docker Environment Configuration
# Copy this file to .env and customize for your environment

# === Server Configuration ===
RUST_LOG=info
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# === Database Configuration ===
POSTGRES_DB=noesis
POSTGRES_USER=noesis_user
POSTGRES_PASSWORD=noesis_password
POSTGRES_HOST_AUTH_METHOD=scram-sha-256
DATABASE_URL=postgresql://noesis_user:noesis_password@postgres:5432/noesis

# === Redis Configuration ===
REDIS_URL=redis://redis:6379
REDIS_POOL_SIZE=10

# === Cache Configuration ===
CACHE_L1_SIZE=268435456  # 256MB
CACHE_L1_TTL=3600        # 1 hour
CACHE_L2_TTL=86400       # 24 hours

# === Authentication ===
JWT_SECRET=development_secret_change_in_production
JWT_EXPIRY=3600  # 1 hour

# === Swiss Ephemeris ===
SWISS_EPHEMERIS_PATH=/app/data/ephemeris

# === Data Paths ===
DATA_PATH=/app/data
WISDOM_DOCS_PATH=/app/data/wisdom-docs

# === Rate Limiting ===
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60  # seconds

# === Feature Flags ===
ENABLE_METRICS=true
ENABLE_WITNESS=true

# === FreeAstrologyAPI.com Integration ===
# Get your free API key from: https://freeastrologyapi.com
# FREE PLAN LIMITS: 50 requests/day, 1 request/second
FREE_ASTROLOGY_API_KEY=your_api_key_here
FREE_ASTROLOGY_API_BASE_URL=https://json.freeastrologyapi.com
FREE_ASTROLOGY_API_TIMEOUT=30  # seconds
FREE_ASTROLOGY_API_RETRY_COUNT=3

# === Rate Limiting (Free Plan: 50/day, 1/sec) ===
FREE_ASTROLOGY_RATE_LIMIT_PER_DAY=50
FREE_ASTROLOGY_RATE_LIMIT_PER_SECOND=1
FREE_ASTROLOGY_RATE_LIMIT_BUFFER=5  # Keep 5 requests as buffer

# === Caching Strategy (Aggressive for free plan) ===
# Birth data: Infinite (never changes)
FREE_ASTROLOGY_CACHE_BIRTH_TTL=0  # 0 = infinite
# Daily Panchang: 24 hours  
FREE_ASTROLOGY_CACHE_DAILY_TTL=86400
# Transits: 1 hour
FREE_ASTROLOGY_CACHE_TRANSIT_TTL=3600
# Pre-fetch days ahead
FREE_ASTROLOGY_PREFETCH_DAYS=7

# === Vedic Engine Provider ===
# Options: "api" (FreeAstrologyAPI) or "native" (local calculation)
VEDIC_ENGINE_PROVIDER=api

# === API Fallback ===
# Fallback to native engines if API is unavailable OR rate limited
VEDIC_ENGINE_FALLBACK_ENABLED=true
VEDIC_ENGINE_FALLBACK_ON_RATE_LIMIT=true
